# MindfulTime - 完整产品开发方案（开源版）

> 完全免费 + 完全开源 + GitHub驱动
> 
> 版本：v1.0
> 日期：2026年2月17日

---

## 📋 核心定位

**一句话描述：**
"首个基于'觉察-引导-改变'理论的开源时间管理工具，用温暖陪伴+温和监督代替冷酷监控"

**价值主张：**
- ❌ 不是Forest的免费替代品
- ❌ 不是功能堆砌的大而全工具  
- ✅ **是基于行为心理学的成长陪伴系统**
- ✅ **是融入中国传统智慧的文化产品**
- ✅ **是社区共建的长期开源项目**
- ✅ **是"陪伴+监督"动态平衡的创新设计**

**核心创新：**
1. **记录动机而非时长**：帮用户看见"为什么刷"而不是"刷多久"
2. **能量条机制**：可视化精力状态，比种树更直观
3. **三阶梯渐进式干预**：根据用户状态动态调整陪伴/监督比例
4. **温柔而明确的文案**：朋友式关怀+适度监督

---

## 📅 18个月产品路线图

### Phase 1: MVP验证期（Month 1-3）

**目标：验证核心假设，获得1,000活跃用户**

#### Month 1: 核心功能开发（MVP）

**核心功能（6个）：**
```
1. 记录动机 ⭐⭐⭐⭐⭐
├─ 平台选择（抖音/视频号/小红书等）
├─ 时长记录
├─ 动机选择（累了放松/无聊/逃避/学习）
└─ 预计能量影响显示

2. 能量条机制 ⭐⭐⭐⭐⭐
├─ 首页实时显示能量（0-100）
├─ 5种能量等级（精力充沛→快撑不住了）
├─ 能量变化实时计算
└─ 视觉化进度条

3. 三阶梯渐进式提醒 ⭐⭐⭐⭐⭐
├─ 阶段一：温柔陪伴（0-30分钟，静默记录）
├─ 阶段二：友善提醒（30-90分钟，温柔推送）
└─ 阶段三：温和监督（90-180分钟+，全屏引导）

4. "我说了算"占比 ⭐⭐⭐⭐
├─ 主动 vs 被动记录
├─ 每日占比计算
└─ 趋势对比

5. 即时引导系统 ⭐⭐⭐⭐
├─ 具体行动建议（倒杯水/站起来/看窗外）
├─ 能量恢复预测
└─ 一键启动微任务

6. 晚报系统 ⭐⭐⭐⭐⭐
├─ 能量变化曲线
├─ 动机分析（今天为什么刷？）
├─ "我说了算"占比
└─ 温暖文案生成
```

**开发计划：**
```
Week 1: 基础架构 + 记录功能
├─ React Native项目初始化
├─ 本地数据库（MMKV + SQLite）
├─ 记录动机功能
└─ 基础UI框架

Week 2: 能量条 + 提醒系统
├─ 能量计算引擎
├─ 能量条UI组件
├─ 三阶梯提醒逻辑
└─ 推送通知

Week 3: 晚报 + 优化
├─ 晚报生成逻辑
├─ 数据可视化
├─ UI/UX细节打磨
└─ 性能优化

Week 4: 测试 + 文档 + 发布
├─ 功能测试
├─ Bug修复
├─ README/CONTRIBUTING
└─ v0.1.0发布
```

**交付物：**
- v0.1.0 MVP版本
- 完整文档（README/CONTRIBUTING/ARCHITECTURE）
- 演示视频（30秒）
- 10个种子用户内测

---

#### Month 2: 优化与迭代

**基于用户反馈优化：**
```
Week 5-6: 核心功能优化
├─ 能量计算规则调整（基于真实数据）
├─ 提醒时机优化（减少打扰）
├─ 文案库扩充（50+ 温暖文案）
└─ 动画流畅度优化

Week 7-8: 新增功能
├─ 能量恢复建议（出去走5分钟+10能量）
├─ 自定义提醒时机（用户可调整）
├─ 数据导出（JSON/CSV）
└─ 深色模式
```

**交付物：**
- v0.2.0 版本
- 用户反馈报告
- 100+ 测试用户

---

#### Month 3: 优化与推广
```
Week 9-10: 体验优化
├─ UI/UX细节打磨
├─ 动画流畅度优化
├─ Bug修复
└─ 性能优化

Week 11-12: 首轮推广
├─ V2EX发帖
├─ 掘金文章
├─ Product Hunt发布
└─ 获得第一批GitHub Star
```

**里程碑：**
- ✅ 1,000 DAU
- ✅ 500+ GitHub Stars
- ✅ 10+ Contributors
- ✅ 次日留存 > 50%

---

### Phase 2: 增长期（Month 4-9）

**目标：扩大用户规模，建立社区文化**

#### Month 4-6: 功能扩展

**新增功能（V1.0）：**
```
1. 种树机制（长期激励）
├─ 专注做事 → 树长大🌳
├─ 刷短视频太久 → 树枯萎🥀
├─ 可浇水复活🌱
└─ 森林成长可视化

2. 成就系统
├─ 连续7天记录 → "觉察新手"徽章
├─ "我说了算"占比>50% → "掌控者"徽章
├─ 单日能量>90 → "能量守护者"徽章
└─ 成就墙展示

3. 数据可视化增强
├─ 7日/30日能量趋势图
├─ 时段分布热力图
├─ 动机分析报告
└─ 对比过去的自己

4. 用户自定义
├─ 调整陪伴-监督比例（10%-90%）
├─ 自定义提醒时机
├─ 自定义微任务
└─ 个性化文案
```

**社区建设：**
- GitHub Discussions开放
- Discord/Telegram群组
- 每月线上分享会
- 贡献者激励计划

---

#### Month 7-9: 平台扩展

**多平台支持：**
```
1. iOS App（TestFlight）
├─ Screen Time API集成
├─ Widget支持
└─ App Store上架

2. Android App
├─ UsageStatsManager集成
├─ Widget支持
└─ Google Play上架

3. Web版（Beta）
├─ 数据同步
├─ 浏览器插件（Chrome）
└─ 跨平台体验一致
```

**推广渠道：**
- Hacker News（Show HN）
- Reddit（r/productivity）
- B站视频教程
- 知乎深度文章

**里程碑：**
- ✅ 10,000 DAU
- ✅ 3,000+ GitHub Stars
- ✅ 50+ Contributors
- ✅ 30日留存 > 35%

---

### Phase 3: 成熟期（Month 10-18）

**目标：成为时间管理类Top 3开源项目**

#### Month 10-12: 智能化升级

**AI功能（可选，基于社区贡献）：**
```
1. 智能分析引擎
├─ 行为模式识别
├─ 危险时刻预警
├─ 个性化建议生成
└─ 本地AI模型（保护隐私）

2. 语音记录（可选）
├─ 讯飞/百度API接入
├─ 每日免费5分钟
└─ 情感分析

3. 博主白名单（视频号）
├─ 手动添加关注博主
├─ 检测更新
├─ 一键直达
└─ 数据对比
```

---

#### Month 13-15: 生态建设

**插件系统：**
```
Plugin API开放
├─ 主题定制
├─ 数据源扩展
├─ 自定义报表
└─ 第三方集成

插件市场（GitHub Pages）
├─ 插件发现
├─ 一键安装
└─ 社区评分
```

**国际化：**
- 英文、日文、韩文
- 多语言文档
- 全球社区运营

---

#### Month 16-18: 影响力扩大

**品牌建设：**
- 官方网站（Next.js）
- 博客（成长故事/技术分享）
- 播客（深度访谈）
- 年度用户大会

**社会价值：**
- 与高校合作（时间管理研究）
- 公益活动（帮助学生群体）
- 开源奖项申请

**里程碑：**
- ✅ 50,000 DAU
- ✅ 10,000+ GitHub Stars
- ✅ 200+ Contributors
- ✅ 成为GitHub Trending #1
- ✅ 获得ProductHunt Golden Kitty提名

---

## 🛡️ 竞争策略与护城河

### 与付费竞品对比

| 维度 | MindfulTime | Forest | Freedom | One Sec |
|-----|------------|--------|---------|---------|
| 价格 | **完全免费** | ¥68 | $39/年 | $9.99 |
| 开源 | **✅ MIT协议** | ❌ | ❌ | ❌ |
| 核心理念 | **温暖陪伴** | 惩罚机制 | 强制阻断 | 深呼吸打断 |
| 数据隐私 | **本地优先** | 云端存储 | 云端存储 | 云端存储 |
| 手动记录 | **✅ 觉察即改变** | ❌ | ❌ | ❌ |
| 中国文化 | **✅ 儒道佛融合** | ❌ | ❌ | ❌ |
| 社区驱动 | **✅ GitHub** | ❌ | ❌ | ❌ |

---

### 5大护城河

#### 1️⃣ 文化护城河 ⭐⭐⭐⭐⭐

**核心差异：**
```
儒家思想融入：
├─ 慎独 → 手动记录是自我觉察
├─ 中庸 → 温和引导而非极端控制
└─ 修身 → 长期身份塑造

道家思想融入：
├─ 无为而治 → 不强制，尊重自主
├─ 上善若水 → 柔性引导，润物无声
└─ 顺势而为 → 识别用户状态，因势利导

佛家思想融入：
├─ 正念觉察 → 观察不批判
├─ 慈悲心 → 温暖陪伴，接纳失败
└─ 当下意识 → 即时引导，活在当下
```

**竞争优势：**
- 西方竞品无法复制的文化底蕴
- 中国用户情感共鸣强
- 可作为学术研究案例

---

#### 2️⃣ 技术护城河 ⭐⭐⭐⭐

**开源技术优势：**
```
1. 社区贡献的功能多样性
   - 不同用户场景的解决方案
   - 快速迭代验证
   - 长尾需求满足

2. 透明的技术实现
   - 代码可审计（安全性）
   - 算法可验证（可信度）
   - 数据可掌控（隐私）

3. 跨平台一致性
   - React Native单一代码库
   - Web/iOS/Android体验统一
   - 维护成本低
```

**技术栈：**
```
前端: React Native + TypeScript
状态: Zustand（轻量级）
存储: MMKV（高性能本地存储）
图表: Victory Native
动画: Reanimated 3
测试: Jest + RTL
```

---

#### 3️⃣ 社区护城河 ⭐⭐⭐⭐⭐

**社区驱动增长：**
```
开发者社区：
├─ GitHub Contributors
├─ 技术博客/教程贡献
├─ 插件生态建设
└─ Code Review文化

用户社区：
├─ GitHub Discussions
├─ Discord/Telegram
├─ 用户故事分享
└─ 互助成长小组

内容社区：
├─ 翻译志愿者
├─ 文档贡献者
├─ 设计师
└─ UX研究者
```

**社区激励：**
- 贡献者名单（README）
- 月度贡献者奖励（虚拟徽章）
- 核心贡献者专属权益
- 年度贡献者大会

---

#### 4️⃣ 数据护城河 ⭐⭐⭐

**隐私优先架构：**
```
本地优先：
├─ 原始数据只存本地
├─ 用户完全掌控
├─ 可选择性同步
└─ 随时导出/删除

匿名化统计：
├─ 只上传汇总数据
├─ 差分隐私保护
├─ 用于AI模型优化
└─ 用户可选择退出
```

**数据价值：**
- 随着用户增长，AI模型持续优化
- 匿名化研究报告（社会价值）
- 但不依赖数据变现（开源精神）

---

#### 5️⃣ 价值观护城河 ⭐⭐⭐⭐⭐

**开源精神：**
```
透明：
├─ 所有代码开源
├─ 产品路线图公开
├─ 决策过程透明
└─ 财务状况公开（如有赞助）

平等：
├─ 所有功能免费
├─ 不设付费墙
├─ 人人可贡献
└─ 社区共同治理

自由：
├─ MIT协议，自由使用
├─ 可Fork定制
├─ 数据可导出
└─ 不被商业绑架
```

**长期主义：**
- 不急于变现
- 专注解决真问题
- 社区可持续发展
- 成为时代遗产

---

## ⚠️ 风险管理与应对

### 风险矩阵

| 风险 | 概率 | 影响 | 等级 | 应对策略 |
|-----|-----|-----|-----|---------|
| 技术实现失败（手动记录被拒绝） | 🟡中 | 🔴高 | **高** | 早期用户访谈验证 |
| 维护者倦怠 | 🟠中高 | 🔴高 | **高** | 培养核心维护者团队 |
| 社区不活跃 | 🟡中 | 🟠中 | **中** | 持续运营+激励机制 |
| 竞品抄袭 | 🟢低 | 🟡低 | **低** | 文化护城河难以复制 |
| 平台政策变化 | 🟡中 | 🟡中 | **中** | 多平台策略 |

---

### 关键风险应对

#### 风险1：用户觉得"手动记录"麻烦 ⚠️高

**风险描述：**
- 用户期待自动监测
- 觉得手动记录增加负担
- 与Forest等自动工具对比

**应对策略：**

1. **价值教育（产品文案）：**
```
❌ "由于技术限制，需要手动记录"
✅ "主动记录，就是主动觉察的开始"

在Onboarding时强调：
"每次记录，都是在问自己：
这真的是我想做的吗？
这一刻，改变就开始了。"
```

2. **降低记录成本：**
```
极简流程（3秒完成）：
Step 1: 点击Widget "刚刷了视频"
Step 2: 选择 "我说了算" or "被带着走"
Step 3: 自动记录，完成！

无需输入时长、无需选App、无需写日记
```

3. **即时反馈强化：**
```
记录后立即：
"记录完成！你比昨天更有觉察力了 💪"
"第15次记录，你的觉察习惯正在养成"
```

4. **社区证明：**
- 展示"X位用户正在使用手动记录"
- 分享成功案例
- 用户故事："手动记录如何改变了我"

---

#### 风险2：开源项目维护倦怠 ⚠️高

**风险描述：**
- 创始人热情消退
- 社区贡献减少
- 项目停滞不前

**应对策略：**

1. **核心维护者培养：**
```
Month 1-3:  创始人独自维护
Month 4-6:  培养2-3名核心贡献者
Month 7-12: 建立维护者小组（5人）
Month 12+:  去中心化治理

选拔标准：
├─ 连续贡献3个月+
├─ 代码质量高
├─ 社区活跃度高
└─ 价值观认同
```

2. **可持续的工作节奏：**
```
每周工作量：
├─ 创始人：10-15小时
├─ 核心维护者：5-10小时
├─ 普通贡献者：随意

避免：
❌ 每天回复所有Issue
❌ 周末加班开发
❌ 承诺不合理的功能

提倡：
✅ 固定时间集中处理
✅ 透明的响应时间（SLA: 48小时）
✅ 定期休息（每季度休1周）
```

3. **资金支持（可选）：**
```
GitHub Sponsors
├─ 个人赞助（$5-50/月）
├─ 企业赞助（$500+/月）
└─ 用途透明（服务器/工具/奖励）

Open Collective
├─ 接受捐赠
├─ 财务公开
└─ 社区决策使用

预期：
Year 1: $0-500/月（不期待）
Year 2: $500-2000/月
Year 3: $2000-5000/月
```

4. **贡献者激励：**
```
非金钱激励：
├─ README贡献者墙
├─ 专属徽章
├─ 核心贡献者证书
├─ 线下meetup邀请
└─ 推荐信（求职）

金钱激励（如有资金）：
├─ 重大功能奖励（$100-500）
├─ Bug Bounty（$20-100）
└─ 文档翻译奖励（$50-200）
```

---

#### 风险3：社区不活跃 ⚠️中

**风险描述：**
- GitHub Star增长停滞
- Issue/PR长期无人响应
- 社区讨论冷清

**应对策略：**

1. **内容营销持续输出：**
```
每周1篇：
├─ 技术博客（掘金/Dev.to）
├─ 用户故事（知乎/小红书）
└─ 产品更新（GitHub Blog）

每月1个：
├─ 视频教程（B站/YouTube）
├─ 线上分享会（腾讯会议）
└─ AMA（Ask Me Anything）
```

2. **新手友好机制：**
```
Good First Issue标签
├─ 文档错误修正
├─ 翻译任务
├─ 简单UI优化
└─ 单元测试补充

新手指南：
├─ 环境搭建教程（视频）
├─ 代码架构讲解
├─ 贡献流程演示
└─ 1对1 Mentor配对
```

3. **定期活动：**
```
月度：
├─ 线上技术分享会
├─ 功能投票（社区决策）
└─ 贡献者排行榜

季度：
├─ Hackathon（48小时开发）
├─ 设计大赛
└─ 用户故事征集

年度：
├─ 年度总结报告
├─ 贡献者大会（线下）
└─ 产品路线图讨论
```

---

## 🔧 技术架构设计

### 架构原则

1. **本地优先（Local-First）**
   - 所有数据本地存储
   - 离线完全可用
   - 可选云端同步

2. **隐私优先（Privacy-First）**
   - 最小化数据收集
   - 端到端加密
   - 用户完全掌控

3. **简单可维护（Simplicity）**
   - 不过度设计
   - 技术栈统一
   - 文档完善

---

### 系统架构图

```
┌─────────────────────────────────────────┐
│          用户设备（iOS/Android/Web）       │
├─────────────────────────────────────────┤
│                                          │
│  ┌────────────────────────────────────┐ │
│  │      React Native App              │ │
│  ├────────────────────────────────────┤ │
│  │  UI Layer                          │ │
│  │  ├─ 快速记录组件                    │ │
│  │  ├─ 复盘展示组件                    │ │
│  │  └─ 微任务组件                      │ │
│  ├────────────────────────────────────┤ │
│  │  Business Logic                    │ │
│  │  ├─ 数据统计计算                    │ │
│  │  ├─ 占比算法                        │ │
│  │  └─ 文案生成                        │ │
│  ├────────────────────────────────────┤ │
│  │  Data Layer                        │ │
│  │  ├─ MMKV (本地存储)                 │ │
│  │  ├─ SQLite (历史数据)               │ │
│  │  └─ Async Storage (设置)           │ │
│  └────────────────────────────────────┘ │
│                                          │
└─────────────┬────────────────────────────┘
              │
              │ (可选同步)
              ▼
┌──────────────────────────────────────────┐
│       云端服务（可选）                      │
├──────────────────────────────────────────┤
│  • 数据备份（加密）                         │
│  • 跨设备同步                              │
│  • 匿名化统计（用户可选）                   │
└──────────────────────────────────────────┘
```

---

### 数据模型设计

#### 核心数据表（SQLite）

```typescript
// 1. 记录表 (records)
interface Record {
  id: string;              // UUID
  timestamp: number;       // Unix时间戳
  platform: string;        // 平台（抖音/视频号/小红书等）
  duration: number;        // 持续时长（分钟）
  motivation: string;      // 动机（累了放松/无聊/逃避/学习）
  type: 'active' | 'passive';  // 我说了算 | 被带着走
  energyBefore: number;    // 记录前能量
  energyAfter: number;     // 记录后能量
  energyChange: number;    // 能量变化
  emotion?: string;        // 感受标签（可选）
  note?: string;           // 备注（可选）
  createdAt: number;
}

// 2. 每日统计表 (daily_stats)
interface DailyStat {
  id: string;
  date: string;            // YYYY-MM-DD
  startEnergy: number;     // 起始能量（默认100）
  endEnergy: number;       // 最终能量
  minEnergy: number;       // 最低能量
  maxEnergy: number;       // 最高能量
  activeCount: number;     // 主动次数
  passiveCount: number;    // 被动次数
  activeRatio: number;     // 主动占比 (0-100)
  totalRecords: number;    // 总记录数
  totalEnergyLost: number; // 总能量消耗
  totalEnergyGained: number; // 总能量恢复
  motivations: Record<string, number>; // 动机分布
  createdAt: number;
  updatedAt: number;
}

// 3. 微任务表 (micro_tasks)
interface MicroTask {
  id: string;
  title: string;           // 任务标题
  duration: number;        // 时长（分钟）
  emoji: string;           // 表情符号
  isDefault: boolean;      // 是否默认任务
  completionCount: number; // 完成次数
  createdAt: number;
}

// 4. 完成记录表 (task_completions)
interface TaskCompletion {
  id: string;
  taskId: string;          // 关联micro_tasks
  completedAt: number;
  feeling?: string;        // 完成后感受
}

// 5. 用户设置表 (settings)
interface Settings {
  id: string;
  userId?: string;         // 用户ID（如有账号）
  theme: 'light' | 'dark' | 'auto';
  language: string;        // zh-CN/en-US
  notificationEnabled: boolean;
  companionSupervisionRatio: number; // 陪伴-监督比例（10-90）
  reminderTiming: {        // 提醒时机（分钟）
    first: number;         // 第一次提醒（默认30）
    second: number;        // 第二次提醒（默认60）
    strong: number;        // 强提醒（默认90）
  };
  syncEnabled: boolean;    // 是否启用云同步
  dataCollection: boolean; // 是否允许匿名统计
  updatedAt: number;
}
```

---

### 核心算法

#### 1. 能量计算引擎 ⭐⭐⭐⭐⭐

```typescript
/**
 * 计算刷短视频消耗的能量
 * @param duration 时长（分钟）
 * @param motivation 动机
 * @returns 能量变化（负数）
 */
function calculateEnergyLoss(
  duration: number,
  motivation: string
): number {
  let baseRate = 0; // 每分钟消耗基础值
  
  // 根据时长阶梯计算
  if (duration <= 30) {
    baseRate = 0.5; // 前30分钟：每分钟-0.5
  } else if (duration <= 60) {
    baseRate = 1.0; // 30-60分钟：每分钟-1
  } else if (duration <= 90) {
    baseRate = 1.5; // 60-90分钟：每分钟-1.5
  } else {
    baseRate = 2.0; // 90分钟+：每分钟-2
  }
  
  // 动机加成
  const motivationMultiplier = {
    '学习': 0.5,      // 学习动机：消耗减半
    '累了放松': 1.0,  // 放松动机：正常消耗
    '无聊': 1.2,      // 无聊动机：消耗+20%
    '逃避': 2.0       // 逃避动机：消耗翻倍
  };
  
  const multiplier = motivationMultiplier[motivation] || 1.0;
  const totalLoss = duration * baseRate * multiplier;
  
  return -Math.round(totalLoss);
}

/**
 * 计算专注做事恢复的能量
 * @param activity 活动类型
 * @param duration 时长（分钟）
 * @returns 能量变化（正数）
 */
function calculateEnergyGain(
  activity: string,
  duration: number
): number {
  const gainRate = {
    '工作学习': 1.0,   // 每分钟+1
    '运动': 1.5,       // 每分钟+1.5
    '阅读': 0.8,       // 每分钟+0.8
    '休息冥想': 0.5,   // 每分钟+0.5
    '户外活动': 2.0    // 每分钟+2（最高）
  };
  
  const rate = gainRate[activity] || 1.0;
  const totalGain = duration * rate;
  
  return Math.round(totalGain);
}

/**
 * 获取能量等级描述
 * @param energy 当前能量（0-100）
 * @returns 等级信息
 */
function getEnergyLevel(energy: number): {
  level: string;
  emoji: string;
  color: string;
  description: string;
} {
  if (energy >= 90) {
    return {
      level: '精力充沛',
      emoji: '🌟',
      color: '#4CAF50',
      description: '能量满满，今天状态真不错！'
    };
  } else if (energy >= 70) {
    return {
      level: '状态不错',
      emoji: '😊',
      color: '#2196F3',
      description: '状态不错，继续保持~'
    };
  } else if (energy >= 50) {
    return {
      level: '还行吧',
      emoji: '😐',
      color: '#FFC107',
      description: '能量有点降低了，要不要休息一下？'
    };
  } else if (energy >= 30) {
    return {
      level: '有点累了',
      emoji: '😔',
      color: '#FF9800',
      description: '能量不太够了，你应该有点累了吧？'
    };
  } else {
    return {
      level: '快撑不住了',
      emoji: '💤',
      color: '#F44336',
      description: '⚠️ 能量告急！你真的需要休息了'
    };
  }
}
```

---

#### 2. "我说了算"占比计算

```typescript
/**
 * 计算主动占比
 * @param records 今日记录列表
 * @returns 主动占比 (0-100)
 */
function calculateActiveRatio(records: Record[]): number {
  if (records.length === 0) return 0;
  
  const activeCount = records.filter(r => r.type === 'active').length;
  const ratio = (activeCount / records.length) * 100;
  
  return Math.round(ratio);
}

/**
 * 生成复盘文案
 */
function generateReviewText(
  todayRatio: number,
  todayEnergy: number,
  yesterdayRatio: number
): string {
  const diff = todayRatio - yesterdayRatio;
  const energyLevel = getEnergyLevel(todayEnergy);
  
  let ratioText = '';
  if (diff > 5) {
    ratioText = `今天"我说了算"占比${todayRatio}%（↑${diff}%）\n你更能做主了！💪`;
  } else if (diff < -5) {
    ratioText = `今天"我说了算"占比${todayRatio}%（↓${Math.abs(diff)}%）\n没关系，明天再来！💙`;
  } else {
    ratioText = `今天"我说了算"占比${todayRatio}%\n保持稳定，继续加油！👍`;
  }
  
  const energyText = `\n\n能量剩余：${todayEnergy}/100\n${energyLevel.description}`;
  
  return ratioText + energyText;
}
```

---

#### 3. 三阶梯提醒触发逻辑

```typescript
/**
 * 判断是否需要提醒以及提醒强度
 * @param currentDuration 当前已刷时长（分钟）
 * @param currentEnergy 当前能量
 * @param settings 用户设置
 * @returns 提醒信息
 */
function shouldTriggerReminder(
  currentDuration: number,
  currentEnergy: number,
  settings: Settings
): {
  shouldRemind: boolean;
  level: 'gentle' | 'friendly' | 'strong';
  message: string;
  actionSuggestions: string[];
} | null {
  const { reminderTiming, companionSupervisionRatio } = settings;
  
  // 阶段一：温柔陪伴（0-30分钟）
  if (currentDuration < reminderTiming.first) {
    return null; // 不提醒
  }
  
  // 阶段二：友善提醒（30-90分钟）
  if (currentDuration >= reminderTiming.first && currentDuration < reminderTiming.strong) {
    const isFirstReminder = currentDuration === reminderTiming.first;
    return {
      shouldRemind: true,
      level: 'friendly',
      message: isFirstReminder 
        ? `刷了${currentDuration}分钟了，累不累？`
        : `已经刷了${currentDuration}分钟了，要不要起来走走？`,
      actionSuggestions: [
        '起来倒杯水💧',
        '看看窗外🌳',
        '伸个懒腰🙆'
      ]
    };
  }
  
  // 阶段三：温和监督（90分钟+）
  if (currentDuration >= reminderTiming.strong) {
    const energyLevel = getEnergyLevel(currentEnergy);
    return {
      shouldRemind: true,
      level: 'strong',
      message: currentDuration >= 180
        ? `🚨 刷了${currentDuration}分钟了\n${energyLevel.description}`
        : `⚠️ 刷了${currentDuration}分钟了\n${energyLevel.description}`,
      actionSuggestions: [
        '站起来',
        '走到窗边',
        '看看最远的地方（20秒）',
        '深呼吸3次'
      ]
    };
  }
  
  return null;
}
```

---

#### 4. 动机分析

```typescript
/**
 * 分析今日刷短视频的动机分布
 * @param records 今日记录
 * @returns 动机分析报告
 */
function analyzeMotivations(records: Record[]): {
  primary: string;
  distribution: Record<string, number>;
  insight: string;
} {
  const motivationCounts: Record<string, number> = {};
  
  records.forEach(record => {
    const motivation = record.motivation;
    motivationCounts[motivation] = (motivationCounts[motivation] || 0) + 1;
  });
  
  // 找出主要动机
  const primary = Object.entries(motivationCounts)
    .sort(([, a], [, b]) => b - a)[0]?.[0] || '无';
  
  // 生成洞察
  let insight = '';
  if (primary === '逃避') {
    insight = '你今天大部分时间在逃避。\n是不是有什么压力？要不要聊聊？';
  } else if (primary === '无聊') {
    insight = '你今天很无聊。\n明天想不想试试做点有趣的事？';
  } else if (primary === '累了放松') {
    insight = '你今天挺累的。\n记得好好休息，别太勉强自己。';
  } else if (primary === '学习') {
    insight = '你今天在用短视频学习。\n记得什么了吗？';
  }
  
  return {
    primary,
    distribution: motivationCounts,
    insight
  };
}
```

---

### 性能优化

#### 1. 启动速度优化

```typescript
// 延迟加载非关键模块
import { lazy, Suspense } from 'react';

const TrendChart = lazy(() => import('./components/TrendChart'));
const Settings = lazy(() => import('./screens/Settings'));

// 使用Suspense包裹
<Suspense fallback={<Loading />}>
  <TrendChart />
</Suspense>
```

#### 2. 数据库查询优化

```sql
-- 添加索引
CREATE INDEX idx_records_date ON records(date(timestamp/1000, 'unixepoch'));
CREATE INDEX idx_records_type ON records(type);

-- 查询今日数据（高频操作）
SELECT * FROM records 
WHERE date(timestamp/1000, 'unixepoch') = date('now')
ORDER BY timestamp DESC;
```

#### 3. 渲染优化

```typescript
// 使用memo避免不必要的重渲染
const RecordCard = React.memo(({ record }: { record: Record }) => {
  return (
    <View>
      <Text>{record.type === 'active' ? '✅ 我说了算' : '🌀 被带着走'}</Text>
    </View>
  );
});

// 使用FlatList虚拟化长列表
<FlatList
  data={records}
  renderItem={({ item }) => <RecordCard record={item} />}
  keyExtractor={item => item.id}
  removeClippedSubviews={true}
  maxToRenderPerBatch={10}
/>
```

---

## 📊 4周MVP开发计划（更新版）

### Week 1: 基础架构 + 记录功能

#### Day 1-2: 项目初始化
```bash
# 创建React Native项目
npx react-native init MindfulTime --template react-native-template-typescript

# 安装核心依赖
npm install @react-navigation/native
npm install react-native-mmkv        # 高性能存储
npm install react-native-sqlite-storage  # 历史数据
npm install zustand                  # 状态管理
npm install date-fns                 # 日期处理
npm install react-native-reanimated  # 动画
npm install @react-native-community/push-notification-ios  # 推送

# 配置ESLint + Prettier
npm install -D eslint prettier @typescript-eslint/parser
```

**任务清单：**
- [ ] 项目结构搭建（src/screens/components/utils/store）
- [ ] 导航配置（React Navigation Stack）
- [ ] 状态管理配置（Zustand store）
- [ ] 本地存储配置（MMKV + SQLite）
- [ ] TypeScript类型定义

---

#### Day 3-5: 记录动机功能
```
功能开发：
├─ 首页UI框架
├─ "记录刷短视频"按钮
├─ 记录弹窗
│   ├─ 平台选择（抖音/视频号/小红书/B站）
│   ├─ 时长输入（快捷选择：15/30/60/90分钟）
│   ├─ 动机选择（累了放松/无聊/逃避/学习）
│   └─ "我说了算" vs "被带着走"
├─ 保存到SQLite
└─ 今日记录列表显示

技术要点：
├─ Modal弹窗组件
├─ SQLite增删改查
├─ 列表渲染优化
└─ 基础动画
```

**交付物：**
- ✅ 可以记录刷短视频（含动机）
- ✅ 可以查看今日记录列表

---

#### Day 6-7: 能量条基础实现
```
功能开发：
├─ 能量计算引擎
│   ├─ calculateEnergyLoss()
│   ├─ calculateEnergyGain()
│   └─ getEnergyLevel()
├─ 首页能量条UI
│   ├─ 进度条组件
│   ├─ 能量等级显示（emoji + 文案）
│   └─ 能量变化动画
├─ 记录时显示能量影响
│   └─ "预计影响：65 → 50 (-15能量)"
└─ 能量值持久化存储

技术要点：
├─ 算法实现（能量计算规则）
├─ Reanimated动画
├─ 实时状态更新
└─ 颜色渐变（绿→黄→橙→红）
```

**Week 1交付物：**
- ✅ 可以记录动机
- ✅ 能量条显示正常
- ✅ 能量计算准确

---

### Week 2: 提醒系统 + "我说了算"占比

#### Day 8-10: 三阶梯提醒系统
```
功能开发：
├─ 提醒触发逻辑
│   ├─ shouldTriggerReminder()
│   ├─ 阶段判断（0-30/30-90/90+）
│   └─ 提醒频率控制
├─ 推送通知集成
│   ├─ iOS本地通知
│   ├─ Android本地通知
│   └─ 通知权限请求
├─ 提醒文案库（50+条）
│   ├─ 温柔陪伴（0-30分钟）
│   ├─ 友善提醒（30-90分钟）
│   └─ 温和监督（90-180分钟+）
└─ 弹窗交互设计
    ├─ 小通知（可忽略）
    ├─ 全屏弹窗（需回应）
    └─ 行动建议列表

技术要点：
├─ 后台定时器
├─ 推送通知API
├─ 弹窗层级管理
└─ 用户交互记录
```

**交付物：**
- ✅ 30/60/90分钟准时提醒
- ✅ 文案温暖且明确
- ✅ 用户可选择回应

---

#### Day 11-12: "我说了算"占比
```
功能开发：
├─ 占比计算
│   ├─ calculateActiveRatio()
│   └─ 每日统计表更新
├─ 占比展示UI
│   ├─ 圆形进度条（0-100%）
│   ├─ 数字高亮
│   └─ 与昨天对比（↑↓）
├─ 温暖文案生成
│   ├─ 进步："你更能做主了！💪"
│   ├─ 退步："没关系，明天再来！💙"
│   └─ 稳定："保持稳定，继续加油！👍"
└─ 趋势展示（简单版）
    └─ 近7天折线图

技术要点：
├─ 统计算法
├─ 图表库（Victory Native或自绘）
├─ 动画过渡
└─ 文案模板引擎
```

**Week 2交付物：**
- ✅ 提醒系统运行稳定
- ✅ "我说了算"占比准确显示

---

### Week 3: 晚报系统 + UI优化

#### Day 13-15: 晚报生成
```
功能开发：
├─ 晚报触发（每晚9点推送）
├─ 晚报数据汇总
│   ├─ 今日能量变化曲线
│   ├─ 刷短视频次数/时长
│   ├─ 动机分析（analyzeMotivations()）
│   ├─ "我说了算"占比
│   └─ 温暖总结文案
├─ 晚报UI设计
│   ├─ 卡片式布局
│   ├─ 能量曲线图
│   ├─ 动机分布饼图
│   └─ 洞察文案高亮
└─ 历史晚报查看

技术要点：
├─ 定时任务（每晚9点）
├─ 数据可视化
├─ 滚动视图优化
└─ 截图分享功能
```

**交付物：**
- ✅ 每晚9点准时生成晚报
- ✅ 数据准确，可视化清晰
- ✅ 文案有洞察力

---

#### Day 16-17: UI/UX优化
```
优化项：
├─ 动画流畅度（60fps）
├─ 按钮触觉反馈（Haptic）
├─ 空状态设计（今日无记录）
├─ 加载状态（骨架屏）
├─ 错误处理（Toast提示）
├─ 颜色主题统一
└─ 适配不同屏幕尺寸

交互优化：
├─ 记录流程缩短为2步
├─ 快捷入口优化
├─ 手势操作（滑动关闭）
└─ 无障碍支持（VoiceOver）
```

**Week 3交付物：**
- ✅ 晚报系统完整
- ✅ UI细节打磨完成

---

### Week 4: 测试 + 文档 + 发布

#### Day 18-20: 全面测试
```
测试清单：
├─ 功能测试
│   ├─ 记录动机流程
│   ├─ 能量计算准确性
│   ├─ 提醒触发时机
│   ├─ "我说了算"占比
│   └─ 晚报生成
├─ 边界情况测试
│   ├─ 极端数值（能量0/100）
│   ├─ 空数据处理
│   ├─ 多次快速记录
│   └─ 后台运行
├─ 性能测试
│   ├─ 启动速度（<3秒）
│   ├─ 内存占用（<100MB）
│   ├─ 数据库查询效率
│   └─ 列表滚动流畅度
├─ 兼容性测试
│   ├─ iOS 14/15/16
│   ├─ Android 10/11/12/13
│   ├─ 不同屏幕尺寸
│   └─ 深色模式
└─ Bug修复

自动化测试（可选）：
├─ Jest单元测试
└─ Detox E2E测试
```

---

#### Day 21-23: 文档编写
```
文档清单：
├─ README.md（中英文）
│   ├─ 项目介绍（核心理念）
│   ├─ 功能特性（6个核心功能）
│   ├─ 截图演示（5张）
│   ├─ 快速开始（安装步骤）
│   ├─ 技术栈说明
│   └─ 开源协议（MIT）
│
├─ CONTRIBUTING.md
│   ├─ 开发环境搭建（详细步骤）
│   ├─ 代码规范（ESLint/Prettier）
│   ├─ Git提交规范（Conventional Commits）
│   ├─ PR流程
│   └─ Good First Issue列表
│
├─ ARCHITECTURE.md
│   ├─ 项目结构说明
│   ├─ 技术架构图
│   ├─ 数据模型设计
│   ├─ 核心算法讲解
│   └─ 性能优化策略
│
├─ CHANGELOG.md
│   └─ v0.1.0发布日志
│
└─ LICENSE
    └─ MIT协议全文
```

**视觉素材：**
- 5张精美截图（首页/记录/能量条/晚报/设置）
- 演示GIF（记录流程，15秒）
- Logo设计（简约风格）

---

#### Day 24: 发布与推广
```
发布清单：
├─ GitHub Release v0.1.0
│   ├─ Release Notes编写
│   ├─ 上传APK（Android）
│   ├─ TestFlight链接（iOS）
│   └─ 源代码压缩包
├─ 演示素材准备
│   ├─ 30秒演示视频
│   ├─ 5张产品截图
│   └─ Slogan："让改变，从记录开始"
└─ 首日推广

推广渠道：
├─ V2EX（/go/create 分享创造）
│   └─ 标题："记录优化时间 - 首个基于'觉察-引导-改变'的开源时间管理工具"
├─ 掘金（沸点 + 文章）
│   ├─ 沸点：产品介绍
│   └─ 文章：技术实现详解
├─ Product Hunt
│   ├─ 产品描述
│   ├─ 演示视频
│   └─ Maker comment
├─ Hacker News（Show HN）
│   └─ "Show HN: MindfulTime – open-source screen time tracker"
├─ Reddit
│   ├─ r/productivity
│   ├─ r/opensource
│   └─ r/reactnative
├─ Twitter/X
│   ├─ 产品推特（带截图）
│   └─ 技术推特（核心算法）
└─ 微信/朋友圈
    └─ 个人社交圈分享
```

**Week 4交付物：**
- ✅ v0.1.0正式发布
- ✅ 完整文档齐全
- ✅ 首批10-50个用户

---

## 🎯 MVP核心指标

### 发布后7天目标：
```
用户增长：
├─ GitHub Stars: 50+
├─ Downloads: 100+
└─ 活跃用户: 30+

功能验证：
├─ 平均记录频率: ≥2次/天
├─ 提醒响应率: ≥30%
└─ 晚报查看率: ≥50%

用户反馈：
├─ Issue数量: 5-10个
├─ 正面反馈: ≥70%
└─ 功能建议: 10+条
```

### 发布后30天目标：
```
用户增长：
├─ GitHub Stars: 200+
├─ Downloads: 500+
├─ 活跃用户: 100+
└─ Contributors: 5+

留存指标：
├─ 次日留存: ≥50%
├─ 7日留存: ≥35%
└─ 30日留存: ≥20%

价值验证：
├─ "我说了算"占比提升: ≥10%
├─ 用户推荐意愿: ≥60%
└─ 继续使用意愿: ≥70%
```

---

## 📈 成功指标

### 北极星指标

**定义：** 每周至少使用3天的活跃用户数
```
WAU_3+ = 每周使用≥3天的用户数
```

**为什么选这个指标？**
- 反映用户真实使用习惯
- 3天是习惯养成的关键阈值
- 与产品价值（改变行为）直接相关

---

### 关键指标体系

#### 1. 增长指标

```
GitHub Stars
├─ Month 1-3:   500+
├─ Month 4-6:   2,000+
├─ Month 7-12:  5,000+
└─ Month 13-18: 10,000+

Downloads (GitHub Releases)
├─ Month 1-3:   1,000+
├─ Month 4-6:   5,000+
├─ Month 7-12:  20,000+
└─ Month 13-18: 50,000+

Contributors
├─ Month 1-3:   10+
├─ Month 4-6:   30+
├─ Month 7-12:  100+
└─ Month 13-18: 200+
```

---

#### 2. 留存指标

```
次日留存: > 50%
7日留存:  > 35%
30日留存: > 20%
90日留存: > 10%

计算方式：
次日留存 = (Day 1回访用户数 / Day 0新用户数) × 100%
```

---

#### 3. 参与指标

```
记录频率:
├─ 每日平均记录次数: 3-5次
└─ 记录完成率: > 80%

微任务完成率:
├─ 收到引导后尝试: > 30%
├─ 完成微任务: > 70%（尝试者）
└─ 重复使用: > 50%

社区活跃度:
├─ Issues/月: 20+
├─ PRs/月: 10+
├─ Discussions活跃: 50+ posts/月
└─ Discord/Telegram活跃: 100+ messages/周
```

---

#### 4. 价值指标

```
用户自评改善:
├─ "我说了算"占比提升: > 15%（30天）
├─ 空虚感下降: > 20%
└─ 主动行为增加: > 30%

Net Promoter Score (NPS):
├─ Month 1-3:   NPS > 30
├─ Month 4-12:  NPS > 50
└─ Month 13-18: NPS > 70

计算方式：
NPS = %推荐者 - %贬损者
```

---

## 🎯 总结：为什么这个产品会成功？

### 1️⃣ 解决真实痛点 ✅

**市场验证：**
- 10亿+短视频用户
- 78%的人认为"刷太多了"
- 现有解决方案效果差

**用户访谈（参考Day1研究）：**
- 意图劫持：85%用户经历过
- 空虚感：70%刷完会空虚
- 改变失败：Forest等工具留存<2周

---

### 2️⃣ 开源策略得当 ✅

**优势：**
- 完全免费，无付费墙
- 社区驱动，快速迭代
- 隐私保护，用户信任
- 文化护城河，竞品难复制

**成功案例：**
- Logseq: 41K stars，知识管理领域
- Obsidian: 虽不完全开源，但社区驱动成功
- RescueTime替代品：市场空缺

---

### 3️⃣ 产品设计科学 ✅

**基于行为心理学：**
- Fogg行为模型：降低行动门槛
- 正向强化：庆祝进步不惩罚
- 自我决定理论：满足自主/能力/归属

**基于中国文化：**
- 儒道佛思想融入
- 温暖文案共鸣
- 差异化竞争

---

### 4️⃣ 技术实现可行 ✅

**MVP可快速验证：**
- 2周完成核心功能
- 手动记录无技术难度
- React Native跨平台

**可持续维护：**
- 代码简洁易读
- 社区可贡献
- 技术债可控

---

### 5️⃣ 长期价值明确 ✅

**社会价值：**
- 帮助用户改变行为
- 减少短视频沉迷
- 促进心理健康

**开源价值：**
- 技术积累开放
- 社区共同成长
- 成为时代遗产

---

## 🚀 立即开始

### 第一步：创建GitHub仓库

```bash
# 1. 创建仓库
Repository name: mindful-time
Description: 首个基于"觉察-引导-改变"理论的开源时间管理工具
License: MIT

# 2. 初始化项目
git clone https://github.com/yourusername/mindful-time.git
cd mindful-time

# 3. 创建React Native项目
npx react-native init MindfulTime --template typescript

# 4. 第一次提交
git add .
git commit -m "feat: 初始化项目"
git push origin main
```

---

### 第二步：完善基础文档

**README.md:**
- 项目介绍（核心理念）
- 功能特性（MVP）
- 快速开始
- 开源协议

**CONTRIBUTING.md:**
- 开发环境搭建
- 代码规范
- 提交流程

---

### 第三步：开始开发

```
Week 1 任务清单：
□ Day 1-2: 项目初始化
□ Day 3-4: 快速记录功能
□ Day 5: 今日复盘
□ Day 6-7: 即时引导

Week 2 任务清单：
□ Day 8-9: UI/UX优化
□ Day 10-11: 测试与修复
□ Day 12-13: 文档完善
□ Day 14: 发布与推广
```

---

## 📞 联系方式

**项目地址：** https://github.com/yourusername/mindful-time

**创始人：** [你的名字]
- Email: your-email@example.com
- Twitter: @yourusername
- 微信: your-wechat-id

**社区：**
- GitHub Discussions: [链接]
- Discord: [链接]
- Telegram: [链接]

---

**让改变，从记录开始。🚀**

---

文档版本：v1.0
最后更新：2026-02-17
文档状态：完整开源方案
下一步：启动2周MVP开发
